<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Clientes</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6">
  <div class="max-w-4xl mx-auto">
    <div class="flex justify-between items-center mb-4">
      <h1 class="text-2xl font-bold">Clientes</h1>
      <button id="btnNuevo" class="bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700">
        + Agregar cliente
      </button>
    </div>
    <table class="min-w-full bg-white shadow rounded-lg overflow-hidden">
      <thead class="bg-gray-200">
        <tr>
          <th class="px-4 py-2">Código</th>
          <th class="px-4 py-2">Nombre</th>
          <th class="px-4 py-2">CUIT</th>
          <th class="px-4 py-2">Razón Social</th>
          <th class="px-4 py-2">IVA</th>
          <th class="px-4 py-2">Corte</th>
          <th class="px-4 py-2">Lista precios</th>
          <th class="px-4 py-2">Acciones</th>
        </tr>
      </thead>
      <tbody id="clientes-body" class="text-gray-700">
        <tr><td colspan="8" class="text-center py-4">Cargando...</td></tr>
      </tbody>
    </table>
  </div>

  <!-- Modal -->
  <div id="modalOverlay" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-xl shadow-xl w-full max-w-lg p-6">
      <div class="flex border-b mb-4">
        <button data-tab="general" class="px-4 py-2 border-b-2 border-blue-600">General</button>
        <button data-tab="cuentas" class="px-4 py-2 text-gray-600">Cuentas</button>
      </div>
      <form id="formCliente" class="space-y-4">
        <!-- Pestaña General -->
        <div id="tab-general">
          <input type="hidden" name="id">
          <label class="block">
            Código interno:
            <input type="text" name="codigo_cliente" readonly class="mt-1 w-full border rounded px-2 py-1 bg-gray-100"/>
          </label>
          <label class="block">
            Nombre:
            <input type="text" name="nombre" required class="mt-1 w-full border rounded px-2 py-1"/>
          </label>
          <label class="block">
            CUIT:
            <input type="text" name="cuit" required class="mt-1 w-full border rounded px-2 py-1"/>
          </label>
          <label class="block">
            Razón Social:
            <input type="text" name="razon_social" required class="mt-1 w-full border rounded px-2 py-1"/>
          </label>
          <label class="block">
            Condición IVA:
            <select name="condicion_iva" required class="mt-1 w-full border rounded px-2 py-1">
              <option>Responsable Inscripto</option>
              <option>Monotributo</option>
              <option>Exento</option>
            </select>
          </label>
          <label class="block">
            Horario de corte:
            <input type="time" name="horario_de_corte" required class="mt-1 w-full border rounded px-2 py-1"/>
          </label>
          <label class="block">
           <select
           id="selectListasPrecios"
           name="lista_precios"
           required
           class="mt-1 w-full border rounded px-2 py-1"></select>
              <!-- Se carga dinámicamente -->
            </select>
          </label>
        </div>

        <!-- Pestaña Cuentas -->
        <div id="tab-cuentas" class="hidden">
          <!-- Controles de auto-ingesta y prueba de token -->
       <div class="flex items-center justify-between bg-gray-50 p-3 rounded border mb-3">
       <label for="chkAutoIngesta" class="font-medium">Ingreso Automatico de envíos </label>
       <input id="chkAutoIngesta" type="checkbox" class="w-5 h-5">
       </div>

       <div class="flex items-center gap-3 mb-4">
       <button type="button" id="btnProbarToken" class="bg-indigo-600 text-white px-3 py-1 rounded hover:bg-indigo-700">
       Probar token MeLi
       </button>
       <span id="pingStatus" class="text-sm text-gray-600"></span>
       </div>

          <div id="cuentasContainer" class="space-y-2"></div>
          <button type="button" id="btnAgregarCuenta"class="mt-2 bg-green-600 text-white px-3 py-1 rounded">Agregar cuenta</button>
          </button>
        </div>

        <div class="flex justify-end space-x-2 pt-4 border-t">
          <button type="button" id="btnCerrar" class="px-4 py-2 rounded border">Cerrar</button>
          <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded">Guardar</button>
        </div>
      </form>
    </div>
  </div>

  <script src="/js/clientes.js" defer></script>
</body>
</html>
